<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amaan Escapes Raccoon</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: purple;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            color: white;
        }
        #gameBox {
            width: 80vw;
            height: 60vh;
            border: 2px solid black;
            position: relative;
            overflow: hidden;
            background-color: white;
        }
        .character {
            width: 50px;
            height: 50px;
            position: absolute;
        }
        #timer, #highScore, #score {
            font-size: 24px;
            margin-bottom: 10px;
        }
        #gheeInput {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Amaan Escapes Raccoon</h1>
    <div id="instructions">Drag the raccoon to chase Amaan. The higher the ghee level, the faster Amaan moves. The faster you catch Amaan, the more points you get. Get even more points by selecting a higher ghee level!</div>
    <div>
        <label for="ghee">Select Ghee Level:</label>
        <input type="number" id="gheeInput" min="1" max="20" value="10">
        <button id="startButton">Start Game</button>
    </div>
    <div id="timer">Time left: 15s</div>
    <div id="highScore">All-time High Score: 0</div>
    <div id="score">Points: 0</div>
    <div id="gameBox">
        <img src="amaan.png" id="amaan" class="character" alt="Amaan">
        <img src="raccoon.png" id="raccoon" class="character" alt="Raccoon">
    </div>
    <div id="message"></div>
    <script>
        const gameBox = document.getElementById('gameBox');
        const amaan = document.getElementById('amaan');
        const raccoon = document.getElementById('raccoon');
        const timer = document.getElementById('timer');
        const highScoreDisplay = document.getElementById('highScore');
        const message = document.getElementById('message');
        const scoreDisplay = document.getElementById('score');
        const gheeInput = document.getElementById('gheeInput');
        const startButton = document.getElementById('startButton');

        let timeLeft = 15;
        let gameRunning = false;
        let amaanSpeed = 100;
        let score = 0;
        let highScore = localStorage.getItem('highScore') || 0;
        highScoreDisplay.textContent = `All-time High Score: ${highScore}`;

        amaan.style.left = '375px';
        amaan.style.top = '275px';
        raccoon.style.left = '0px';
        raccoon.style.top = '0px';

        let amaanX = parseInt(amaan.style.left);
        let amaanY = parseInt(amaan.style.top);
        let raccoonX = parseInt(raccoon.style.left);
        let raccoonY = parseInt(raccoon.style.top);

        let amaanDirectionX = Math.random() < 0.5 ? -1 : 1;
        let amaanDirectionY = Math.random() < 0.5 ? -1 : 1;

        raccoon.addEventListener('mousedown', startDrag);
        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('mousemove', drag);

        raccoon.addEventListener('touchstart', startDrag);
        document.addEventListener('touchend', stopDrag);
        document.addEventListener('touchmove', drag);

        let isDragging = false;

        function startDrag(e) {
            isDragging = true;
        }

        function stopDrag() {
            isDragging = false;
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();
                const rect = gameBox.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;

                raccoonX = clientX - rect.left - raccoon.clientWidth / 2;
                raccoonY = clientY - rect.top - raccoon.clientHeight / 2;

                if (raccoonX < 0) raccoonX = 0;
                if (raccoonY < 0) raccoonY = 0;
                if (raccoonX > rect.width - raccoon.clientWidth) raccoonX = rect.width - raccoon.clientWidth;
                if (raccoonY > rect.height - raccoon.clientHeight) raccoonY = rect.height - raccoon.clientHeight;

                raccoon.style.left = raccoonX + 'px';
                raccoon.style.top = raccoonY + 'px';
            }
        }

        function moveAmaan() {
            if (!gameRunning) return;

            const amaanRect = amaan.getBoundingClientRect();
            const raccoonRect = raccoon.getBoundingClientRect();
            const dx = amaanRect.left - raccoonRect.left;
            const dy = amaanRect.top - raccoonRect.top;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance < 100) {  // Move away from raccoon when close
                amaanDirectionX = dx > 0 ? 1 : -1;
                amaanDirectionY = dy > 0 ? 1 : -1;
            } else {
                if (amaanX <= 0 || amaanX >= gameBox.clientWidth - amaan.clientWidth) {
                    amaanDirectionX *= -1;
                }
                if (amaanY <= 0 || amaanY >= gameBox.clientHeight - amaan.clientHeight) {
                    amaanDirectionY *= -1;
                }
            }

            amaanX += amaanDirectionX * amaanSpeed * 0.01;
            amaanY += amaanDirectionY * amaanSpeed * 0.01;

            if (amaanX < 0) amaanX = 0;
            if (amaanY < 0) amaanY = 0;
            if (amaanX > gameBox.clientWidth - amaan.clientWidth) amaanX = gameBox.clientWidth - amaan.clientWidth;
            if (amaanY > gameBox.clientHeight - amaan.clientHeight) amaanY = gameBox.clientHeight - amaan.clientHeight;

            amaan.style.left = amaanX + 'px';
            amaan.style.top = amaanY + 'px';

            if (distance < 50) {  // Check for collision
                gameRunning = false;
                clearInterval(amaanInterval);
                clearInterval(timerInterval);
                message.textContent = 'Caught!';
                let gheeLevel = parseInt(gheeInput.value);
                timeTaken = 15 - timeLeft;
                score = Math.max(0, (15 - timeTaken) * gheeLevel * 100);
                scoreDisplay.textContent = `Points: ${score}`;
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('highScore', highScore);
                    highScoreDisplay.textContent = `All-time High Score: ${highScore}`;
                }
            }
        }

        function updateTimer() {
            if (!gameRunning) return;

            timeLeft--;
            timer.textContent = `Time left: ${timeLeft}s`;
            if (timeLeft <= 0) {
                gameRunning = false;
                clearInterval(amaanInterval);
                message.textContent = 'You lost! Amaan escaped!';
                scoreDisplay.textContent = `Points: 0`;
            }
        }

        function startGame() {
            timeLeft = 15;
            gameRunning = true;
            amaanSpeed = parseInt(gheeInput.value) * 100;
            timer.textContent = `Time left: 15s`;
            message.textContent = '';
            scoreDisplay.textContent = 'Points: 0';
            amaan.style.left = '375px';
            amaan.style.top = '275px';
            raccoon.style.left = '0px';
            raccoon.style.top = '0px';
            amaanX = parseInt(amaan.style.left);
            amaanY = parseInt(amaan.style.top);
            raccoonX = parseInt(raccoon.style.left);
            raccoonY = parseInt(raccoon.style.top);

            amaanInterval = setInterval(moveAmaan, 20);
            timerInterval = setInterval(updateTimer, 1000);
        }

        startButton.addEventListener('click', startGame);
    </script>
</body>
</html>
